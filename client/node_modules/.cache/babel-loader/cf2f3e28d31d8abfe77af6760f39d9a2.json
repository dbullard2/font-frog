{"ast":null,"code":"import { SubstitutionAction } from './featureQuery';\n/**\n * Apply single substitution format 1\n * @param {Array} substitutions substitutions\n * @param {any} tokens a list of tokens\n * @param {number} index token index\n */\n\nfunction singleSubstitutionFormat1(action, tokens, index) {\n  tokens[index].setState(action.tag, action.substitution);\n}\n/**\n * Apply single substitution format 2\n * @param {Array} substitutions substitutions\n * @param {any} tokens a list of tokens\n * @param {number} index token index\n */\n\n\nfunction singleSubstitutionFormat2(action, tokens, index) {\n  tokens[index].setState(action.tag, action.substitution);\n}\n/**\n * Apply chaining context substitution format 3\n * @param {Array} substitutions substitutions\n * @param {any} tokens a list of tokens\n * @param {number} index token index\n */\n\n\nfunction chainingSubstitutionFormat3(action, tokens, index) {\n  action.substitution.forEach(function (subst, offset) {\n    var token = tokens[index + offset];\n    token.setState(action.tag, subst);\n  });\n}\n/**\n * Apply ligature substitution format 1\n * @param {Array} substitutions substitutions\n * @param {any} tokens a list of tokens\n * @param {number} index token index\n */\n\n\nfunction ligatureSubstitutionFormat1(action, tokens, index) {\n  var token = tokens[index];\n  token.setState(action.tag, action.substitution.ligGlyph);\n  var compsCount = action.substitution.components.length;\n\n  for (var i = 0; i < compsCount; i++) {\n    token = tokens[index + i + 1];\n    token.setState('deleted', true);\n  }\n}\n/**\n * Supported substitutions\n */\n\n\nvar SUBSTITUTIONS = {\n  11: singleSubstitutionFormat1,\n  12: singleSubstitutionFormat2,\n  63: chainingSubstitutionFormat3,\n  41: ligatureSubstitutionFormat1\n};\n/**\n * Apply substitutions to a list of tokens\n * @param {Array} substitutions substitutions\n * @param {any} tokens a list of tokens\n * @param {number} index token index\n */\n\nfunction applySubstitution(action, tokens, index) {\n  if (action instanceof SubstitutionAction) {\n    SUBSTITUTIONS[action.id](action, tokens, index);\n  }\n}\n\nexport default applySubstitution;","map":null,"metadata":{},"sourceType":"module"}