{"ast":null,"code":"// The `hmtx` table contains the horizontal metrics for all glyphs.\n// https://www.microsoft.com/typography/OTSPEC/hmtx.htm\nimport parse from '../parse';\nimport table from '../table';\n\nfunction parseHmtxTableAll(data, start, numMetrics, numGlyphs, glyphs) {\n  var advanceWidth;\n  var leftSideBearing;\n  var p = new parse.Parser(data, start);\n\n  for (var i = 0; i < numGlyphs; i += 1) {\n    // If the font is monospaced, only one entry is needed. This last entry applies to all subsequent glyphs.\n    if (i < numMetrics) {\n      advanceWidth = p.parseUShort();\n      leftSideBearing = p.parseShort();\n    }\n\n    var glyph = glyphs.get(i);\n    glyph.advanceWidth = advanceWidth;\n    glyph.leftSideBearing = leftSideBearing;\n  }\n}\n\nfunction parseHmtxTableOnLowMemory(font, data, start, numMetrics, numGlyphs) {\n  font._hmtxTableData = {};\n  var advanceWidth;\n  var leftSideBearing;\n  var p = new parse.Parser(data, start);\n\n  for (var i = 0; i < numGlyphs; i += 1) {\n    // If the font is monospaced, only one entry is needed. This last entry applies to all subsequent glyphs.\n    if (i < numMetrics) {\n      advanceWidth = p.parseUShort();\n      leftSideBearing = p.parseShort();\n    }\n\n    font._hmtxTableData[i] = {\n      advanceWidth: advanceWidth,\n      leftSideBearing: leftSideBearing\n    };\n  }\n} // Parse the `hmtx` table, which contains the horizontal metrics for all glyphs.\n// This function augments the glyph array, adding the advanceWidth and leftSideBearing to each glyph.\n\n\nfunction parseHmtxTable(font, data, start, numMetrics, numGlyphs, glyphs, opt) {\n  if (opt.lowMemory) parseHmtxTableOnLowMemory(font, data, start, numMetrics, numGlyphs);else parseHmtxTableAll(data, start, numMetrics, numGlyphs, glyphs);\n}\n\nfunction makeHmtxTable(glyphs) {\n  var t = new table.Table('hmtx', []);\n\n  for (var i = 0; i < glyphs.length; i += 1) {\n    var glyph = glyphs.get(i);\n    var advanceWidth = glyph.advanceWidth || 0;\n    var leftSideBearing = glyph.leftSideBearing || 0;\n    t.fields.push({\n      name: 'advanceWidth_' + i,\n      type: 'USHORT',\n      value: advanceWidth\n    });\n    t.fields.push({\n      name: 'leftSideBearing_' + i,\n      type: 'SHORT',\n      value: leftSideBearing\n    });\n  }\n\n  return t;\n}\n\nexport default {\n  parse: parseHmtxTable,\n  make: makeHmtxTable\n};","map":null,"metadata":{},"sourceType":"module"}